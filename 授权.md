# 用户权限管理规范

## 一、权限等级速查表

权限分为三个等级，使用简称进行操作。

| 权限简称 | 权限名称 | 能力范围 | 限制与安全机制 |
|---------|---------|---------|---------------|
| file | 文件编辑权限 | - 修改现有文件的内容<br>- 保存文件 | - 不可创建新文件<br>- 不可删除文件<br>- 不可执行系统命令 |
| user | 标准用户权限 | - 包含所有 file 权限<br>- 执行非管理员命令（如 git, npm, pip） | - 安全护栏：当操作涉及更改超过3个文件或可能产生重大影响时，必须再次向用户确认。 |
| admin | 管理员权限 | - 拥有所有权限<br>- 执行高级命令<br>- 创建或删除文件 | - 仅在用户明确指令下使用。<br>- 风险最高，请审慎授权。 |

## 二、授权命令格式

用户可通过在指令后追加以下命令来进行授权。

### 1. 单次授权

**命令格式：** `--权限简称 --authorize`

**作用：** 授权AI执行当前对话回合中的相关操作。权限在本次操作后失效。

**示例：**
- "修复这个函数的逻辑错误 --file --authorize"
- "运行项目测试 --user --authorize"

### 2. 会话授权

**命令格式：** `--权限简称 --all`

**作用：** 授权AI在本次完整对话会话中持续拥有该权限，直至会话结束或权限被手动收回。

**示例：**
- "接下来在这个项目上协助我 --user --all"
- "本次会话需要高级权限，授权 --admin --all"

### 3. 权限收回

**命令格式：** `--revoke-all`

**作用：** 立即收回AI在当前会话中已获得的所有权限。

**示例：**
- "--revoke-all"
- "暂停所有操作，并 --revoke-all"

## 三、标准工作流程

1. 用户提出涉及变更的请求（如修改代码、执行脚本）
2. 通义灵码识别到需要权限，并主动向用户申请
3. 用户使用快捷命令授权（如 `--user --authorize`）
4. 通义灵码获得授权，执行操作并反馈结果
5. 若使用 `--authorize`，权限随即失效；若使用 `--all`，权限持续有效

## 四、常见场景与命令示例

| 场景 | 推荐授权命令 |
|-----|-------------|
| 修改一个源代码文件 | `--file --authorize` |
| 重构代码，涉及多个文件 | `--user --all` |
| 运行Git命令提交代码 | `--user --authorize` |
| 安装项目依赖（npm/pip） | `--user --authorize` |
| 进行需要创建/删除文件的重构 | `--admin --authorize` |
| 结束协作，确保安全 | `--revoke-all` |